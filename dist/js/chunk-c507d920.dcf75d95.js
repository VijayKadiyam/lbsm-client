(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c507d920"],{"7a7f":function(e,t,a){"use strict";a("b8d9")},"7dca":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main-content"},[t("breadcumb",{attrs:{page:"Upload User",folder:"User"}}),t("b-row",{staticClass:"justify-content-md-center"},[t("b-col",{attrs:{md:"12"}},[t("b-card",{staticClass:"mb-4"},[t("b-row",[t("b-col",{attrs:{md:"12"}},[t("a",{attrs:{href:"".concat(e.mediaUrl,"samples/user-sample-data.xlsx"),target:"_blank"}},[e._v(" [ Download Sample Excel ] ")]),t("br"),t("input",{ref:"file",staticClass:"mb-2",attrs:{type:"file",id:"file",name:"file",accept:"application/ms-excel"}}),t("br"),t("b-button",{staticClass:"btn d-none d-sm-block",attrs:{variant:"primary"},on:{click:e.truncatePendingDocuments}},[t("i",{staticClass:"i-Delete-File text-white mr-2"}),e._v("Truncate List ")])],1)],1),t("b-row",[t("b-col",{attrs:{md:"12"}},[t("br"),t("br"),t("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.message)+" ")]),e.isLoading?t("b-progress",{staticClass:"mb-2",attrs:{value:e.changeValue,max:e.max,animated:""}}):e._e(),0==e.crudeUsers.length?t("b-button",{attrs:{block:"",variant:"primary"},on:{click:e.handleFileUpload}},[e._v("Upload file")]):t("b-button",{attrs:{block:"",variant:"primary"},on:{click:e.processFile}},[e._v("Process file")])],1)],1)],1)],1)],1),t("b-row",{staticClass:"justify-content-md-center"},[t("b-col",{attrs:{md:"12"}},[t("b-card",[t("vue-good-table",{attrs:{columns:e.columns,"line-numbers":!0,"search-options":{enabled:!0,placeholder:"Search this table"},"pagination-options":{enabled:!0,mode:"records"},styleClass:"tableOne vgt-table",rows:e.crudeUsers}})],1)],1)],1)],1)},n=[],r=a("c7eb"),c=a("1da1"),i=a("bc3a"),o=a.n(i),l={metaInfo:{title:"Upload User Excel"},data:function(){return{form:{promotion_date:""},crudeUsers:[],columns:[{label:"Nationality",field:"nationality"},{label:"Rank",field:"rank"},{label:"First Name",field:"first_name"},{label:"Middle Name",field:"middle_name"},{label:"Last Name",field:"last_name"},{label:"DANAOS ID",field:"danaos_id"},{label:"B-Date",field:"dob"}],searchingStatus:"",changeValue:0,changeMax:100,submitStatus:null}},mounted:function(){this.form.site_id=this.site.id,this.getData()},methods:{getData:function(){var e=arguments,t=this;return Object(c["a"])(Object(r["a"])().mark((function a(){var s,n;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e.length>0&&void 0!==e[0]?e[0]:1,t.isLoading=!0,t.searchingStatus="Searching...",t.changeValue=100,a.next=6,o.a.get("/crude_users");case 6:n=a.sent,t.crudeUsers=n.data.data,t.count=n.data.count,t.serialNoStarting=(s-1)*t.rowsPerPage,t.isLoading=!1,t.searchingStatus="";case 12:case"end":return a.stop()}}),a)})))()},handleFileUpload:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!0,e.users=e.$refs.file.files[0],a=new FormData,a.append("usersData",e.users),e.changeValue=100,t.next=7,o.a.post("upload_user",a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){t.data.data&&(e.crudeUsers=t.data.data),e.isLoading=!1,alert("Uploaded Successfully")})).catch((function(){console.log("FAILURE!!")}));case 7:e.isLoading=!1;case 8:case"end":return t.stop()}}),t)})))()},processFile:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,e.changeValue=100,t.next=5,o.a.get("process_user?is_existing_batch=".concat(e.form.is_existing_batch?1:0));case 5:return alert("Processed Successfully"),t.next=8,o.a.get("truncate_users");case 8:e.crudeUsers=[],e.isLoading=!1,t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},truncatePendingDocuments:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.a.get("truncate_users");case 2:alert("Truncated Successfully"),e.crudeUsers=[];case 4:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this;return Object(c["a"])(Object(r["a"])().mark((function t(){return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("submit!"),e.form.user_id=e.selectedUser[0].id,e.form.program_id=e.selectedProgram[0].id,e.form.program_post_id=e.selectedProgramPost[0].id,e.$v.$touch(),!e.$v.$invalid){t.next=9;break}e.submitStatus="ERROR",t.next=22;break;case 9:return t.prev=9,e.isLoading=!0,e.submitStatus="PENDING",t.next=14,o.a.post("/user_program_posts",e.form);case 14:e.isLoading=!1,e.submitStatus="OK",e.$router.push("/app/user-program-posts/"),t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](9),e.isLoading=!1;case 22:case"end":return t.stop()}}),t,null,[[9,19]])})))()},makeToast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$bvToast.toast("Please fill the form correctly.",{title:"Variant ".concat(e||"default"),variant:e,solid:!0})},makeToastTwo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$bvToast.toast("Successfully Submitted",{title:"Variant ".concat(e||"default"),variant:e,solid:!0})},inputSubmit:function(){console.log("submitted")}}},u=l,d=(a("7a7f"),a("2877")),b=Object(d["a"])(u,s,n,!1,null,null,null);t["default"]=b.exports},b8d9:function(e,t,a){}}]);